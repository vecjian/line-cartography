<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
  <style>
    canvas {
      border: 1px solid black;
    }
  </style>
</head>

<body>
  <canvas id="paint0" width="1080" height="900" style="height: auto; width: auto"></canvas>
  <!-- <canvas id="paint1" width="400" height="400" style="height: auto; width: auto"></canvas>
  <canvas id="paint2" width="400" height="400" style="height: auto; width: auto"></canvas> -->
  <!-- <canvas id="paint3" width="400" height="400" style="height: auto; width: auto"></canvas> -->
  <!-- <canvas id="paint4" width="400" height="400" style="height: auto; width: auto"></canvas> -->
  <!-- <canvas id="paint5" width="400" height="400" style="height: auto; width: auto"></canvas> -->
  <!-- <canvas id="paint6" width="400" height="400" style="height: auto; width: auto"></canvas> -->
  <!-- <canvas id="paint7" width="400" height="400" style="height: auto; width: auto"></canvas> -->

  <!-- <script src="./js/."></script> -->
  <script src="./lib/earcut.dev.js"></script>
  <script src="./lib/GL_Util1.js"></script>
  <script src="./lib/dat.gui.js"></script>

  <script src="./data/originData.js"></script>
  <script src="./data/border_simplify.js"></script>
  <script src="./data/border_simplify1.js"></script>
  <script src="./data/border0.js"></script>
  <script src="./data/generalization.js"></script>
  <script src="./data/road.js"></script>
  <script src="./data/Road1-1.js"></script>
  <script src="./data/twoRoad.js"></script>
  <!-- <script src="./data/forest_Project.js"></script> -->
  <script src="./data/forest2.js"></script>
  <script src="./data/forest1.js"></script>
  <script src="./data/forest.js"></script>

  <script src="./data/contour.js"></script>
  <script src="./data/contour2.js"></script>
  <script src="./data/contour3.js"></script>
  <script src="./data/contour4.js"></script>
  <script src="./data/contour8.js"></script>
  <script src="./data/contour7.js"></script>
  <script src="./data/contour9.js"></script>
  <!-- <script src="./data/tree_Project.js"></script>
  <script src="./data/tree1_Project.js"></script> -->
  <script src="./data/tree1.js"></script>
  <script src="./data/tree2.js"></script>
  <script src="./data/tree3.js"></script>
  <script src="./data/tree4.js"></script>
  <script src="./data/tree5.js"></script>
  <script src="./data/tree6.js"></script>
  <script src="./data/tree7.js"></script>
  <script src="./data/tree8.js"></script>
  <script src="./data/tree9.js"></script>
  <script src="./data/tree10.js"></script>

  <script src="./data/oneline4.js"></script>
  <script src="./data/oneline5.js"></script>
  <script src="./data/oneline1.js"></script>
  <script src="./data/oneline.js"></script>
  <script src="./data/oneline3.js"></script>
  <script src="./data/oneline2.js"></script>
  <script src="./data/oneRoad.js"></script>
  <script src="./data/oneRiver.js"></script>
  <script src="./data/oneRiver1.js"></script>
  <script src="./data/oneRiver2.js"></script>
  <script src="./data/oneRiver3.js"></script>
  <script src="./data/oneRiver3_1.js"></script>
  <script src="./data/generalization.js"></script>
  <script src="./data/longLine.js"></script>
  <script src="./data/longLine1.js"></script>
  <script src="./data/longLine2.js"></script>


  <script src="./js/BinaryTree.js"></script>

  <script src="./js/draw.js"></script>
  <script src="./js/PointInTri.js"></script>
  <script src="./js/symbol.js"></script>
  <script src="./js/boundaryLine.js"></script>
  <script src="./js/smoothLine.js"></script>
  <script src="./js/drawLine.js"></script>
  <script src="./js/index.js"></script>
  <script src="./js/bridge.js"></script>
  <script src="./js/displacement.js"></script>
  <script src="./js/contour.js"></script>
  <script src="./js/simplify.js"></script>


  <script>
    // var pts = initLine(5);
    //初始化非封闭线段
    function initcentralLine(m, n) {
      const a = 0.05;
      var vectors = [];
      for (var i = 0; i < 20; i++) {
        let point = new Point(m, n);
        vectors.push(point);
        m = m + a;
        n = n + a;
      }
      return vectors;
    }

    // 双线
    function doubleLine() {
      // 初始化中心线坐标
      let initline = initcentralLine(-0.2, -0.2);
      // let initline = initclosedLine(-0.2, -0.2);
      let triangleStrip = generateDoubleLine(initline, 0.05);
      var gl = getContextgl2();
      drawlines(gl, triangleStrip, true, false);
    }

    // 三线
    function threeLine() {
      // 初始化中心线坐标
      let initline = initcentralLine(-0.2, -0.2);
      let triangleStrip = generateDoubleLine(initline, 0.05);
      var gl = getContextgl1();
      drawlines(gl, triangleStrip, true, true);
    }

    //境界线
    function borderStrip() {
      //初始化界线
      // var points = getBorder(border);
      var points = getBorder(oneRoad);
      getArea(points);
      // points = douglasPeucker(points,0.0006)
      // let triangleStrip = generateBorderStrip(points, 0.15);
      let triangleStrip = generateBorderStrip(points, 0.007);
      var gl = getContextgl4();

      // drawBorderArea(triangleStrip, false, true); //带区域面
      drawBorder(gl, triangleStrip, false, true); //不带区域面
    }

    //二叉树渐变河流网
    // let stroke_array = getMapStructure(originData, false); //同时生成boundary
    let stroke_array = getMapStructure(forest2, false); //同时生成boundary//森林中不能含有人工的河道，必须是天然的河流
    // let stroke_array = getMapStructure(tree5, false); //同时生成boundary

    function display_forest() {
      // clearBoundary();
      //森林
      let forest = new Forest();
      forest.newForest(stroke_array);
      forest.DrawForest();
      // clearBoundary()
    }

    //河流网的冲突检测，树
    function riverNet() {
      var gl = getContextgl5();
      get_Whole_arr(stroke_array, 0.0008, gl);
      clearBoundary();
    }

    //单线看效果
    function draw_oneLine() {
      clearBoundary();
      let stroke_array2 = getMapStructure(Road1, false);
      // let stroke_array2 = getMapStructure(road, false);
      var gl = getContextgl3();
      // draw_detect(gl, stroke_array2[0].points, 0.0010);
      draw_detect(gl, stroke_array2[0]. points, 0.012);
      clearBoundary();
    }

    //单线移位
    function draw_oneline1() {
      clearBoundary()
      let stroke_array2 = getMapStructure(Road1, false);
      var gl = getContextgl6();
      // detect_displacement_draw(gl, stroke_array2[0].points, 0.6, 0.00055)
      detect_displacement_draw(gl, stroke_array2[0].points, -0.05, 0.012)
      clearBoundary();
    }


    //等高线
    function draw_contour() {
      clearBoundary()
      let stroke_array3 = getMapStructure(contour4, false); //同时生成boundary
      var gl = getContextgl7();
      get_Whole_arr(stroke_array3, 50, gl);
      clearBoundary()
    }



    //河流网
    display_forest(); //渐变河网
    // riverNet(); //未渐变

    // borderStrip();//境界线
    // doubleLine();//双线道路
    // threeLine();//三线道路
    // draw_oneLine(); //单线效果

    // draw_oneline1()

    // draw_contour()
    //着色器计算连续插值

    // draw_contours(contour9, 30 )//绘制等高线并绘，会改变boundary的值
    // draw_contours(twoRoad, 0.005 )//绘制等高线并绘，会改变boundary的值

    // init();
  </script>
  <script>
    function initGUI(){
        var simpleLine =  {
            width : 15,
            feather:false,
            gradient:false,
            data:'forest',
            // triangle:false,
            cap: 'butt',
            joint: 'miter'

        };

        var points = [-0.5,0.4, -0.9,0.2, -0.6,0 , -0.9,-0.2];      
        var obj = simpleLine;
        var gui = new dat.GUI();
        gui.add(obj,'feather').onChange(redraw);
        gui.add(obj, 'gradient').onChange(redraw);
        // gui.add(obj,'triangle').onChange(redraw);
        // gui.add(obj,'centralline').onChange(redrwa);

        gui.add(obj, 'width').min(1).max(50).step(0.3).onFinishChange(redraw);
        gui.add(obj, 'data', ['forest', 'tree','oneline']).onChange(redraw);
        gui.add(obj, 'cap', ['round', 'square','butt']).onChange(redraw);

        gui.add(obj, 'joint', ['round', 'miter','bevel']).onChange(redraw);

        var oFolder = gui.addFolder('其他');

        function redraw(){

            // drawDifferJoint(simpleLine);
            // spliteTriangle(simpleLine,PS);
            // getThreeTriangleStrip(PS,simpleLine);
            threeAntialiased(gl, coors[0], simpleLine);
            threeAntialiased(gl, coors[1], simpleLine);
            threeAntialiased(gl, coors[2], simpleLine);
        
        };
    }
initGUI()
  </script>
</body>

</html>