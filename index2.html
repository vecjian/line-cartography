<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Document</title>
</head>

<body>
  <canvas id="webgl" width="400" height="400" style="height: auto; width: auto"></canvas>
  <canvas id="paint" width="400" height="400" style="height: auto; width: auto"></canvas>
  <canvas id="paint1" width="400" height="400" style="height: auto; width: auto"></canvas>
  <canvas id="paint2" width="400" height="400" style="height: auto; width: auto"></canvas>

  <script src="./PointInTri.js"></script>
  <script src="./symbol.js"></script>
  <script src="./boundaryLine.js"></script>
  <script src="./BinaryTree.js"></script>
  <script src="./lib/GL_Util.js"></script>
  <script src="./lib/earcut.dev.js"></script>
  <script src="./data/network_1.js"></script>
  <script src="./data/border_simplify.js"></script>
  <script src="./smoothLine.js"></script>

  <script>
    // var pts = initLine(5);
    //初始化非封闭线段
    function initcentralLine(m, n) {
      const a = 0.05;
      var vectors = [];
      for (var i = 0; i < 20; i++) {
        let point = new Point(m, n);
        vectors.push(point);
        m = m + a;
        n = n + a;
      }
      return vectors;
    }

    //初始化封闭线段,境界线必须要是封闭的吗？
    function initclosedLine() {
      var vectors = [];
      var point = new Point(-0.7, 0, 0);
      var point1 = new Point(-0.5, -0.6);
      var point2 = new Point(0.0, 0.0);
      var point3 = new Point(0.5, 0.4);
      var point4 = new Point(0.8, 0.6);
      var point5 = new Point(0.6, 0.9);
      var point6 = new Point(0.0, 0.95);
      var point7 = new Point(-0.6, 0.5);
      var point8 = new Point(-0.8, 0.4);
      vectors.push(point);
      vectors.push(point1);
      vectors.push(point2);
      vectors.push(point3);
      vectors.push(point4);
      vectors.push(point5);
      vectors.push(point6);
      vectors.push(point7);
      vectors.push(point8)
      vectors.push(point);

      let pts = smoothLine(vectors, 1)
      return pts;
    }

    // 双线
    function doubleLine() {
      // 初始化中心线坐标
      let initline = initcentralLine(-0.2, -0.2);
      // let initline = initclosedLine(-0.2, -0.2);
      let triangleStrip = generateDoubleLine(initline, 0.05);
      var gl = getContextgl();
      lines(gl, triangleStrip, false, false);
    }

    // 三线
    function threeLine() {
      // 初始化中心线坐标
      let innitline = initcentralLine(-0.2, -0.2);
      let triangleStrip = generateDoubleLine(innitline, 0.05);
      var gl = getContextgl1();
      lines(gl, triangleStrip, false, true);
    }

    //河流网所有河段
    let stroke_array = getMapStructure(originData, true);

    function display_forest() {
      let forest = new Forest();
      forest.newForest(stroke_array);
      forest.DrawForest();
    }

    //境界线
    function borderStrip() {
      //初始化界线
      getArea(points);
      // let points = initclosedLine();
      let triangleStrip = generateBorderStrip(points, 0.15);
      drawBorderArea(triangleStrip, false, true);
      // drawBorder(triangleStrip, false, true);
    }


    //河流网
    //获取数据
    var points = getBorder(border);
    borderStrip();
    display_forest();
    doubleLine();
    threeLine();
  </script>
</body>

</html>